<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>installing mateplus - Josef Ruppenhofer</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://ruppenhofer.de/mateplus.html">

        <meta name="author" content="Josef Ruppenhofer" />
        <meta name="keywords" content="software" />
        <meta name="description" content="installing mateplus" />

        <meta property="og:site_name" content="Josef Ruppenhofer" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="installing mateplus"/>
        <meta property="og:url" content="http://ruppenhofer.de/mateplus.html"/>
        <meta property="og:description" content="installing mateplus"/>
        <meta property="article:published_time" content="2016-01-23" />
            <meta property="article:section" content="Blog" />
            <meta property="article:tag" content="software" />
            <meta property="article:author" content="Josef Ruppenhofer" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://ruppenhofer.de/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://ruppenhofer.de/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://ruppenhofer.de/theme/css/pygments/native.css" rel="stylesheet">
        <link href="http://ruppenhofer.de/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://ruppenhofer.de/theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://ruppenhofer.de/" class="navbar-brand">
Josef Ruppenhofer            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="http://ruppenhofer.de/pages/Affiliations.html">Affiliations</a></li>
                    <li><a href="http://ruppenhofer.de/pages/contact.html">Contact</a></li>
                    <li><a href="http://ruppenhofer.de/pages/data sets.html">Datasets</a></li>
                    <li><a href="http://ruppenhofer.de/pages/research interests.html">Research</a></li>
                    <li><a href="http://ruppenhofer.de/pages/publications.html">Publications</a></li>
                    <li><a href="http://ruppenhofer.de/pages/teaching.html">Teaching</a></li>
                        <li class="active">
                            <a href="http://ruppenhofer.de/category/blog.html">Blog</a>
                        </li>
                        <li >
                            <a href="http://ruppenhofer.de/category/general.html">General</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://ruppenhofer.de/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://ruppenhofer.de/mateplus.html"
                       rel="bookmark"
                       title="Permalink to installing mateplus">
                        installing&nbsp;mateplus
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-01-23T10:20:00+01:00"> Sat 23 January 2016</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://ruppenhofer.de/tag/software.html">software</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Last update: Thu Jan 19 16:16:08 <span class="caps">CET</span>&nbsp;2017 </p>
<p>This is a brief note about what to do to get 
<a href="https://github.com/microth/mateplus">mateplus </a>
running for the purpose of framenet-style semantic role&nbsp;labeling.</p>
<p><span class="caps">NB</span>: the info below may not be complete as it is reconstructed from memory
 after I got mateplus running. Please let me know if anything is missing
 so I can update&nbsp;this.</p>
<h1>Download the&nbsp;models</h1>
<ul>
<li>Personally, I put all the stuff into one sister directory of mateplus (which i called&nbsp;&#8220;mateplus_companion_software&#8221;).</li>
<li>Under mateplus, I then created two symlinks &#8220;lib&#8221; and &#8220;models&#8221;, both pointing to the dir for the companion software so that mateplus can find the&nbsp;stuff.</li>
</ul>
<h1>Install basic&nbsp;components</h1>
<p>Make sure you have a machine where you have permissions to open ports on so that you can install 
the components that mateplus relies&nbsp;on.</p>
<p>Below, I am assuming that mateplus and the software that is accessed in server mode runs on 
the same machine , i.e.&nbsp;&#8216;localhost&#8217;.</p>
<ul>
<li>
<p>install semafor 3 (alpha version): we need the server mode that this newer version of semafor&nbsp;provides</p>
</li>
<li>
<p>install  semafor 2-1 : we need the server mode of the <span class="caps">MST</span> parser that this version of semafor&nbsp;provides</p>
</li>
</ul>
<h1>set up <span class="caps">MST</span> for server&nbsp;mode</h1>
<p>To get <span class="caps">MST</span> parser (included in semafor 2-1) ready for the server mode that semafor 2.1 provides,
go into the &#8220;release&#8221; directory of semafor 2-1. In there, modify the &#8220;config&#8221; file such that it uses the <span class="caps">MST</span>&nbsp;mode</p>
<ul>
<li>set MST_MACHINE=localhost (or specify <span class="caps">IP</span>)</li>
<li>set the port number as&nbsp;needed</li>
<li>set&nbsp;&#8220;MST_MODE=server&#8221;</li>
</ul>
<p>Then, under the &#8220;release&#8221; directory of semafor 2-1, run the bash script&nbsp;&#8220;startMSTServer.sh&#8221;</p>
<h1>start semafor&nbsp;3</h1>
<ul>
<li>edit the file &#8220;bin/config.sh&#8221; to set&nbsp;paths</li>
<li>start the server mode : adjust paths , ports and memory in the command as&nbsp;needed</li>
<li>note the port number: you will need it later for the setup of&nbsp;mateplus</li>
</ul>
<p>java -Xms6g -Xmx6g -cp target/Semafor-3.0-alpha-04.jar edu.cmu.cs.lti.ark.fn.SemaforSocketServer model-dir:/mnt/medium/tools/maltparser/semafor_malt_model&nbsp;port:8043</p>
<h1>stanford&nbsp;corenlp</h1>
<p>Use stanford corenlp version 3.7: the mateplus readme online mentions &#8220;3.x.x&#8221; but at this point no other versions  &gt;= 3..0.0 work if you want to use the frame semantic  parsing&nbsp;scripts.</p>
<h1>adjust&nbsp;&#8220;glove&#8221;</h1>
<ul>
<li>
<p>I downloaded and extracted glove into a subdir of&nbsp;&#8220;mateplus_companion_software&#8221;.</p>
</li>
<li>
<p>I modified the original glove&#8217;s dir &#8220;processtmp.sh&#8221; file, adjusting some&nbsp;variables</p>
</li>
</ul>
<blockquote>
<p><span class="caps">GLOVEDIR</span>=/mnt/medium/tools/mateplus_companion_software/glovey<br/>
 SCALE_FILE=/mnt/medium/tools/mateplus_companion_software/glovey/scaleparams.txt<br/>
 SAVE_FILE=$1.vectors // in hind-sight not quite sure if this setting is what&#8217;s needed<br/>
 <span class="caps">MEMORY</span>=10.0 // set depending on your hardware: the implicit unit assumed here is <span class="caps">GB</span>!</p>
</blockquote>
<p><span class="caps">NB</span>: a brief caveat: So far I have only run mateplus on mini example files with two sentences or so.
However, i&#8217;ve noticed that the temp files for cooccurrences (coocs) and shufflings (coocs.shuf) that glove creates in the tmp dir are always empty. I am not sure if this is suspicous and means that glove is not correctly&nbsp;configured.</p>
<blockquote>
<p>-rw-rw-r&#8212;  1 ruppenho ruppenho    0 Jan 19 22:55 glv3829134863266861581.txt.coocs<br />
-rw-rw-r&#8212;  1 ruppenho ruppenho    0 Jan 19 22:55&nbsp;glv3829134863266861581.txt.coocs.shuf</p>
</blockquote>
<h1>adjust run&nbsp;scripts</h1>
<p>adjust the bash files under &#8220;scripts &#8220;, fix paths and/or file names, set the ports so they match the specification in the semafor 2-1 and semafor-3 config&nbsp;files</p>
<p>&#8212; contents of my file &#8220;parse-framenet.sh&#8221;&nbsp;&#8212;</p>
<blockquote>
<p><span class="caps">JAVA</span>=/etc/alternatives/java</p>
<p># directory to which fndata-1.5 was extracted<br/>
# the dir we mean should have as its immediate subdirs : docs, frame, fulltext , schema, lu
<span class="caps">FRAMENETDIR</span>=/mnt/big/lexicons/<span class="caps">FN</span>/fn.r1.5<br/>
# matetools models downloaded from web<br/>
LEMMA_MODEL=models/CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.lemmatizer.model
POS_MODEL=models/CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.postagger.model
PARSER_MODEL=models/CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.parser.model</p>
<p># directory in which glove10a was extracted<br/>
# (please also modify processtmp.sh in glove dir accordingly!)<br/>
<span class="caps">GLOVEDIR</span>=/mnt/medium/tools/mateplus_companion_software/glovey </p>
<p>$<span class="caps">JAVA</span> -Xmx8g -cp lib/*:mateplus.jar se.lth.cs.srl.CompletePipeline eng \ <br/>
-lemma $LEMMA_MODEL \ <br/>
-parser $PARSER_MODEL \ <br/>
-tagger $POS_MODEL \ <br/>
-srl models/srl-<span class="caps">TACL15</span>-eng.model \<br/>
-glove $<span class="caps">GLOVEDIR</span> \ <br/>
- reranker -globalFeats -semafor &#8220;127.0.0.1 8043&#8221; -mst &#8220;127.0.0.1 12345&#8221; -framenet $<span class="caps">FRAMENETDIR</span> -test&nbsp;$1</p>
</blockquote>
<p>&#8212; end contents of&nbsp;&#8220;parse-framenet.sh&#8221;</p>
<h1>adjust processtmp.sh in glove&nbsp;installation</h1>
<p>As a reference, here is my processtmp.sh file from the glove&nbsp;installation:</p>
<p>&#8212;- processtmp.sh&nbsp;&#8212;-</p>
<blockquote>
<p>#!/bin/bash
<span class="caps">GLOVEDIR</span>=/mnt/medium/tools/mateplus_companion_software/glovey<br/></p>
<p><span class="caps">CORPUS</span>=$1<br/>
VOCAB_FILE=$1.vocab<br/>
COOCCURRENCE_FILE=$1.coocs<br/>
COOCCURRENCE_SHUF_FILE=$1.coocs.shuf<br/>
LOAD_FILE=$1.init<br/>
GRADSQ_FILE=$1.grad<br/>
SCALE_FILE=/mnt/medium/tools/mateplus_companion_software/glovey/scaleparams.txt<br/>
SAVE_FILE=$1.vectors<br/></p>
<p>#SAVE_FILE=tmp/$1<br/>
<span class="caps">VERBOSE</span>=2<br/>
<span class="caps">MEMORY</span>=10.0<br/>
VOCAB_MIN_COUNT=0<br/>
VECTOR_SIZE=50<br/>
MAX_ITER=10<br/>
WINDOW_SIZE=10<br/>
<span class="caps">BINARY</span>=0<br/>
NUM_THREADS=1<br/>
X_MAX=100<br/></p>
<p>echo &#8220;Corpus &#8220;.$<span class="caps">CORPUS</span><br/>
#$<span class="caps">GLOVEDIR</span>/vocab_count -min-count 0 -verbose $<span class="caps">VERBOSE</span> &lt; $<span class="caps">CORPUS</span> &gt; $1.vocab<br/>
$<span class="caps">GLOVEDIR</span>/cooccur++ -memory $<span class="caps">MEMORY</span> -vocab-file $VOCAB_FILE -verbose $<span class="caps">VERBOSE</span> -window-size $WINDOW_SIZE &lt; $<span class="caps">CORPUS</span> &gt; $COOCCURRENCE_FILE<br/>
#   ./cooccur -memory $<span class="caps">MEMORY</span> -vocab-file $VOCAB_FILE -verbose $<span class="caps">VERBOSE</span> -window-size $WINDOW_SIZE &lt; $<span class="caps">CORPUS</span> &gt; $COOCCURRENCE_FILE<br/>
echo $COOCCURRENCE_FILE<br/></p>
<p>#$<span class="caps">GLOVEDIR</span>/cooccur   -memory $<span class="caps">MEMORY</span> -vocab-file $VOCAB_FILE -verbose $<span class="caps">VERBOSE</span> -window-size $WINDOW_SIZE  &lt; $<span class="caps">CORPUS</span> &gt; $COOCCURRENCE_FILE<br/>
# ./cooccur -verbose 2 -symmetric 0 -window-size 10 -vocab-file vocab.txt -memory 8.0 -overflow-file tempoverflow &lt; corpus.txt &gt; cooccurrences.bin<br/></p>
<p>if [[ $? -eq 0 ]]<br/>
then<br/>
    $<span class="caps">GLOVEDIR</span>/shuffle -memory $<span class="caps">MEMORY</span> -verbose $<span class="caps">VERBOSE</span> &lt; $COOCCURRENCE_FILE &gt; $COOCCURRENCE_SHUF_FILE<br/>
    if [[ $? -eq 0 ]]<br/>
    then<br/>
        #-load-gradsq $GRADSQ_FILE -load-file $LOAD_FILE<br/>
       $<span class="caps">GLOVEDIR</span>/glove -save-file $SAVE_FILE -threads $NUM_THREADS -input-file $COOCCURRENCE_SHUF_FILE -x-max $X_MAX -iter $MAX_ITER -vector-size $VECTOR_SIZE -binary $<span class="caps">BINARY</span> -vocab-file $VOCAB_FILE -verbose $<span class="caps">VERBOSE</span> -model 0<br/>
       echo &#8220;now off to perl&#8221;<br/>
       perl $<span class="caps">GLOVEDIR</span>/removeBiasCenterAndScale.pl $SAVE_FILE.txt $SCALE_FILE $1.vocab &gt; $1.vectors<br/>
   fi<br/>
fi<br/></p>
</blockquote>
<p>&#8212;- end contents of processtmp.sh&nbsp;&#8212;-</p>
<h2>Companion&nbsp;software</h2>
<p>Just for completeness&#8217; sake, I list the downloaded models and libraries that are in my companion software dir.
Note: this dir (accidentally) contains files extracted from the glove tar ball. However, i re-extracted that tar-ball 
inside the dir &#8220;glovey&#8221; again - those files are what I used. In particular, I modified the processtmp.sh file contained in that&nbsp;dir.</p>
<p>I am using slightly older versions of opennlp-maxent<em> and opennlp-tools</em> that I already had. I assume the newer versions that Michael Roth specified in his readme would work as well.  Some of my files are just symlinked, which is&nbsp;ok.</p>
<ul>
<li>anna-3.3.jar</li>
<li>CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.lemmatizer.model*</li>
<li>CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.parser.model*</li>
<li>CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.postagger.model*</li>
<li>CoNLL2009-<span class="caps">ST</span>-English-<span class="caps">ALL</span>.anna-3.3.srl-4.1.srl.model*</li>
<li>cooccur*</li>
<li>cooccur++*</li>
<li>cooccur.c</li>
<li>cooccur++.c</li>
<li>demo.sh*</li>
<li>de-token.bin</li>
<li>eval/</li>
<li>glove*</li>
<li>glove.c</li>
<li>glovey/</li>
<li>gradsq.txt</li>
<li>lemma-ger-3.6.model*</li>
<li>liblinear-1.51-with-deps.jar</li>
<li>liblinear-java-1.95.jar</li>
<li><span class="caps">LICENSE</span></li>
<li>makefile</li>
<li>opennlp-maxent-3.0.2-incubating.jar</li>
<li>opennlp-tools-1.5.2-incubating.jar</li>
<li>processtmp.sh*</li>
<li><span class="caps">README</span></li>
<li>removeBiasCenterAndScale.pl</li>
<li>scaleparams.txt</li>
<li>shuffle*</li>
<li>shuffle.c</li>
<li>srl-<span class="caps">EMNLP14</span>+fs-eng.model*</li>
<li>srl-<span class="caps">EMNLP14</span>+fs-extger.model*</li>
<li>srl-<span class="caps">EMNLP14</span>+fs-ger.model*</li>
<li>srl-<span class="caps">TACL15</span>-eng.model*</li>
<li>stanford-corenlp-3.7.0.jar -&gt;&nbsp;/mnt/medium/tools/stanfordCoreNLP/stanford-corenlp-full-2016-10-31/+stanford-corenlp-3.7.0.jar</li>
<li>stanford-corenlp-3.7.0-javadoc.jar -&gt;&nbsp;/mnt/medium/tools/stanfordCoreNLP/stanford-corenlp-full-2016-10-31/stanford-corenlp-3.7.0-javadoc.jar</li>
<li>stanford-corenlp-3.7.0-models.jar -&gt;&nbsp;/mnt/medium/tools/stanfordCoreNLP/stanford-corenlp-full-2016-10-31/stanford-corenlp-3.7.0-models.jar</li>
<li>stanford-corenlp-3.7.0-sources.jar -&gt;&nbsp;/mnt/medium/tools/stanfordCoreNLP/stanford-corenlp-full-2016-10-31/stanford-corenlp-3.7.0-sources.jar</li>
<li>transition-1.30.jar</li>
<li>vectors.txt</li>
<li>vocab_count*</li>
<li>vocab_count.c</li>
<li>vocab.txt</li>
<li>whatswrong-0.2.3.jar</li>
</ul>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">





    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://wisscamp.de/en/" target="_blank">
                LWC
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://ruppenhofer.de/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://ruppenhofer.de/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://ruppenhofer.de/theme/js/respond.min.js"></script>


</body>
</html>